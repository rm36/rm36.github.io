<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<style> circle {stroke: black;} </style>
<body onload='init()'>
<svg width=300 height=300>
</svg>
<script>
async function init() {
    data = await d3.csv('https://rm36.github.io/cars2017.csv');
    var height = 200;
    var width = 200;

    var x = d3.scaleLog().base(10).domain([10, 150]).range([0,width]);
    var y = d3.scaleLog().base(10).domain([10, 150]).range([height, 0]);
    var color = d3.scaleLinear().domain([0,6,12]).range(['#8888FF', 'purple', 'pink'])
    var margin = 50;

    var svg = d3.select('svg')
                .attr('width', width+2*margin)
                .attr('height', height+2*margin)

    svg.append('g').attr('transform', 'translate('+margin+','+margin+')')
       .selectAll('circle').data(data).enter().append('circle')
       .attr('cx', function(d,i) { return x(parseInt(d.AverageCityMPG)); })
       .attr('cy', function(d,i) { return y(parseInt(d.AverageHighwayMPG)); })  
       .attr('r', function(d,i) { return parseInt(d.EngineCylinders) + 2; })
       .attr('fill', function(d,i) { return color(parseInt(d.EngineCylinders)); });

    svg.append('g').attr('transform', 'translate('+margin+','+margin+')')
                   .call(d3.axisLeft(y).tickValues([10,20,50,100])
                                      .tickFormat(d3.format("~s")));
    svg.append('g').attr('transform', 'translate('+margin+','+(height+margin)+')')
                   .call(d3.axisBottom(x).tickValues([10,20,50,100])
                                      .tickFormat(d3.format("~s")));
    }
</script>
</body>
</html>